import numpy as np
from scipy.special import erf

# Функция ошибки для численного интегрирования
def erf_numeric(x, n=1000):
    a, b = 0, x  # пределы интегрирования
    y = (2 / np.sqrt(np.pi)) * np.exp(-np.linspace(a, b, n + 1)**2)
    integral = (b - a) / n * (np.sum(y[:-1]) + np.sum(y[1:])) / 2
    return integral

# Генерация таблицы значений
x_values = np.arange(0.0, 2.1, 0.1)
erf_values_numeric = [erf_numeric(x) for x in x_values]
erf_values_exact = [erf(x) for x in x_values]

# Вывод таблицы
print(" x    erf через интеграл   erf табличное     Error")
for x, num, exact in zip(x_values, erf_values_numeric, erf_values_exact):
    print(f"{x:4.1f}   {num}   {exact}   {abs(num - exact):.2e}")
#Метод численных квадратур — это семейство методов численного интегрирования для приближённого вычисления значения определённого интеграла. 1

#Общий принцип метода: область интегрирования разбивается по каждой из осей на равное количество частей. 
#В каждой из полученных маленьких областей интеграл приближается простой функцией (например, линейной), 
#значение которой вычисляется явно (путём вычисления подынтегрального выражения в одной или нескольких точках). 
#Ввиду линейности оператора интегрирования по областям полученные значения суммируются и представляют собой результат интегрирования. 1
